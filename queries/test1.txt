Sort 1
Aggregate 1
Gather Merge 1
Aggregate 1
Sort 1
Nested Loop 2
Hash Join 2     Index Scan 0
Seq Scan 0      Hash 1
Seq Scan 0

Sort 1
Aggregate 1
Hash Join 2
Hash Join 2     Hash 1
Seq Scan 0      Hash 1  Seq Scan 0
Seq Scan 0

q1 = '''
EXPLAIN (VERBOSE, ANALYZE, FORMAT JSON)
select
      l_orderkey,
      sum(l_extendedprice * (1 - l_discount)) as revenue,
      o_orderdate,
      o_shippriority
    from
      customer,
      orders,
      lineitem
    where
      c_mktsegment = 'BUILDING'
      and c_custkey = o_custkey
      and l_orderkey = o_orderkey
      and o_totalprice > 10
      and l_extendedprice > 10
    group by
      l_orderkey,
      o_orderdate,
      o_shippriority
    order by
      revenue desc,
      o_orderdate;
'''

q2 = '''
EXPLAIN (VERBOSE, ANALYZE, FORMAT JSON)
select
      l_orderkey,
      sum(l_extendedprice * (1 - l_discount)) as revenue,
      o_orderdate,
      o_shippriority
    from
      customer,
      orders,
      lineitem
    where
      c_custkey = o_custkey
      and l_orderkey = o_orderkey
    group by
      l_orderkey,
      o_orderdate,
      o_shippriority
    order by
      revenue desc,
      o_orderdate;
'''