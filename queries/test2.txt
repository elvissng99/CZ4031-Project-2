Aggregate 1
Gather Merge 1
Sort 1
Aggregate 1
Nested Loop 2
Seq Scan 0      Index Scan 0

Aggregate 1
Gather Merge 1
Sort 1
Aggregate 1
Seq Scan 0

q1 = '''
EXPLAIN (VERBOSE, ANALYZE, FORMAT JSON)
select
      o_orderpriority,
      count(*) as order_count
    from
      orders
    where
      o_totalprice > 100
      and exists (
        select
          *
        from
          lineitem
        where
          l_orderkey = o_orderkey
          and l_extendedprice > 100
      )
    group by
      o_orderpriority
    order by
      o_orderpriority;
'''

q2 = '''
EXPLAIN (VERBOSE, ANALYZE, FORMAT JSON)
select
      o_orderpriority,
      count(*) as order_count
    from
      orders
    where
      o_totalprice > 100
    group by
      o_orderpriority
    order by
      o_orderpriority;
'''